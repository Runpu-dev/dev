name: Sync Docker Hub Image to Private Registry

on:
  workflow_dispatch:  # 可手动触发工作流

jobs:
  sync-image:
    runs-on: ubuntu-latest  # 使用 Ubuntu 虚拟机

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4  # 确保仓库的代码也被检出

      - name: Log in to Private Registry
        run: echo "${{ secrets.REGISTRY_PASSWORD }}" | docker login ${{ secrets.REGISTRY_SERVER }} -u ${{ secrets.REGISTRY_USERNAME }} --password-stdin
        # 登录私有镜像仓库

      - name: Pull image from Docker Hub
        run: docker pull nginx:latest  # 从 Docker Hub 拉取镜像

      - name: Tag image for Private Registry
        run: docker tag nginx:latest ${{ secrets.REGISTRY_SERVER }}/your-namespace/nginx:latest
        # 打标签

      - name: Push image to Private Registry
        run: docker push ${{ secrets.REGISTRY_SERVER }}/your-namespace/nginx:latest
        # 推送镜像到私有仓库
